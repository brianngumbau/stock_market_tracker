<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ symbol }} Chart</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script> <!-- Using Plotly -->
    <style>
        /* Custom styles */
        body {
            background-color: #f0f2f5; /* Light background */
        }
        #chart {
            height: 600px; /* Set height for the chart */
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <div class="row">
            <div class="col-md-12">
                <!-- Chart Controls -->
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h1>Stock Chart for {{ symbol }}</h1>
                    <div class="btn-group" role="group">
                        <button id="1M" class="btn btn-outline-secondary">1M</button>
                        <button id="3M" class="btn btn-outline-secondary">3M</button>
                        <button id="6M" class="btn btn-outline-secondary">6M</button>
                        <button id="1Y" class="btn btn-outline-secondary active">1Y</button>
                    </div>
                </div>

                <!-- Chart Container -->
                <div id="chart" class="border rounded bg-white"></div>
            </div>
        </div>
    </div>

    <script>
        var stockData = {{ stock_data | tojson }};
        
        // Initialize the chart with the full 1-year data (default)
        var dates = stockData.index;
        var open = stockData.Open;
        var close = stockData.Close;
        var high = stockData.High;
        var low = stockData.Low;
        var volume = stockData.Volume;

        var trace1 = {
            x: dates,
            open: open,
            high: high,
            low: low,
            close: close,
            type: 'candlestick',
            name: '{{ symbol }}',
            increasing: { line: { color: 'green' } },
            decreasing: { line: { color: 'red' } }
        };

        var layout = {
            title: 'Candlestick Chart for {{ symbol }}',
            xaxis: { title: 'Date' },
            yaxis: { title: 'Price (USD)' },
            plot_bgcolor: "#f8f9fa",
            paper_bgcolor: "#ffffff",
            font: { color: '#333' },
            dragmode: 'zoom',
            margin: { t: 50 }
        };

        Plotly.newPlot('chart', [trace1], layout);

        // Handle button clicks for range filtering
        document.querySelectorAll('.btn-group button').forEach(btn => {
            btn.addEventListener('click', function() {
                // Update chart based on range
            });
        });
    </script>
</body>
</html>